## 4.5 인덱스

### 4.5.1 인덱스의 필요성

인덱스는 저장 공간에 추가적인 쓰기 작업을 하여 데이터베이스 테이블의 검색 속도를 향상시키기 위한 자료구조이다.

인덱스를 활용하면, 데이터를 조회하는 SELECT 외에도 UPDATE나 DELETE의 성능이 함께 향상된다.

**인덱스를 사용하면 좋은 경우**

- 규모가 작지 않은 테이블
- INSERT, UPDATE, DELETE가 자주 발생하지 않는 컬럼
- JOIN이나 WHERE 또는 ORDER BY에 자주 사용되는 컬럼
- 데이터의 중복도가 낮은 컬럼

**인덱스가 효율적인 이유와 대수확장성**

인덱스가 효율적인 이유는 효율적인 단계를 거쳐 모든 요소에 접근할 수 있는 균형잡힌 트리 구조와 트리 깊이의 **대수확장성** 때문이다.

대수확장성: 트리 깊이가 리프 노드 수에 비해 매우 느리게 성장하는 것

인덱스가 한 깊이씩 증가할 때 최대 인덱스 항목의 수를 4배씩 증가시킨다.

### 4.5.2 인덱스 관리 방식

**인덱스의 관리**

인덱스는 항상 최신의 정렬된 상태로 유지되어야 하므로 그에 따른 오버헤드가 발생한다.

- INSERT: 새로운 데이터에 대한 인덱스 추가
- DELETE: 삭제하는 데이터의 인덱스 제거
- UPDATE: 기존의 인덱스 제거 및 갱신된 데이터에 인덱스 추가

**B-트리**

B-트리는 이진트리를 확장해 하나의 노드가 더 많은 자식을 가질 수 있게 일반화한 자료구조이다.

데이터베이스, 파일 시스템에서 널리 사용되는 트리 자료구조의 일종이다.

자식 노드를 둘 이상 가질 수 있고 Balanced Tree 라는 특징이 있다. → 즉 탐색 연산에 있어 O(log N)의 시간복잡도를 갖는다.

모든 노드들에 대해 값을 저장하고 있으며 포인터 역할을 동반한다.

1. 노드에는 2개 이상의 데이터(key)가 들어갈 수 있으며, 항상 정렬된 상태로 저장된다.
<p align="center"><img width="35%" src="https://github.com/STUDY-0x0E/CS-STUDY/assets/39394642/477dc97b-23b1-4ca6-a32a-51f842c99955"></p>

2. M차 B트리의 내부 노드는 M/2 ~ M개의 자식을 가질 수 있다.
<p align="center"><img width="70%" src="https://github.com/STUDY-0x0E/CS-STUDY/assets/39394642/dccd2157-2422-4847-95d7-3ba8a5846e59"></p>

3. 특정 노드의 데이터(key)가 K개라면, 자식 노드의 개수는 K+1개여야 한다.
<p align="center"><img width="70%" src="https://github.com/STUDY-0x0E/CS-STUDY/assets/39394642/0b621039-21ee-4672-9591-c611e70aac9c"></p>

4. 특정 노드의 왼쪽 서브 트리는 특정 노드의 key 보다 작은 값들로, 오른쪽 서브 트리는 큰 값들로 구성된다.
<p align="center"><img width="70%" src="https://github.com/STUDY-0x0E/CS-STUDY/assets/39394642/f50a805c-06a4-408c-a34f-d03428fa2eae"></p>

5. 모든 리프 노드들이 같은 레벨에 존재한다.
<p align="center"><img width="70%" src="https://github.com/STUDY-0x0E/CS-STUDY/assets/39394642/a39c5d21-4fa0-4cf9-b7b7-a97a9f10bf32"></p>


**B+트리**

B+Tree는 DB의 인덱스를 위해 자식 노드가 2개 이상인 B-Tree를 개선시킨 자료구조이다.

B+Tree는 모든 노드에 데이터(Value)를 저장했던 BTree와 다르게 리프노드(데이터노드)만 인덱스와 함께 데이터(Value)를 가지고 있고, 나머지 노드(인덱스노드)들은 데이터를 위한 인덱스(Key)만을 갖는다.
리프노드들은 LinkedList로 연결되어 있다. → 때문에 부등호문 연산에 대해 효과적이다.

리프 노드를 제외한 노드들은 포인터의 역할만을 수행한다.
