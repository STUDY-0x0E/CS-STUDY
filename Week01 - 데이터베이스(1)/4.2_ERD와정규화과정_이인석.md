- ERD : 설계도

# 무결성 제약 조건

- 데이터베이스에 저장된 무결성을 보장하고, 데이터베이스의 상태를 일관되게 유지하기 위한 조건
- 개체 무결성
    - 모든 테이블은 기본키를 가지며, 기본키는 고유한 값이어야 하고 Non-Null이어야 한다
    - 테이블 내의 모든 레코드는 중복될 수 없다
- 참조 무결성
    - 외래키 값은 NULL이거나 참조하는 릴레이션의 기본키 값과 동일해야 한다
        - ex) 외래키로 참조하는 데이터가 사라지면 무결성 위반에 해당한다
    - Trigger, On Update, On Delete로 해결 가능
- 도메인 무결성
    - 테이블 내 필드의 논리적인 무결성 보장 ⇒ 속성의 도메인에 맞는 데이터 삽입 해야 한다
    - 제약조건 명시, 올바른 타입 설정
- 키 무결성
    - 하나의 테이블은 최소 하나의 키를 가진다
- 추가적으로 null 무결성, 고유 무결성이 있음

# 이상 현상 (Anomaly)

- 테이블 설계 오류로 데이터 삽입, 수정, 삭제 시 생기는 오류
- 데이터의 무결성이 저하되고, 실제 값과 데이터베이스의 값이 일치하지 않는 문제가 발생
    - 정규화를 통해 해결할 수 있음

## 삽입 이상

- 데이터 삽입을 위해 불필요한 데이터를 추가해야만 삽입이 가능한 현상

## 삭제 이상

- 특정 데이터 삭제 시 의도치 않는 다른 데이터도 삭제되는 현상

## 갱신 이상

- 특정 데이터 변경 시 다른 데이터와의 정합성이 깨지는 현상

# 정규화

- 릴레이션 간의 데이터베이스 이상 현상이 일어나서 이를 해결하거나, 저장 공간을 효율적으로 사용하기 위해 릴레이션을 여러 개로 분리하는 과정
- 정규형 원칙
    - 같은 의미를 표현하는 릴레이션이지만 더 좋은 구조로 만들어야 한다.
    - 자료의 중복성은 감소해야 한다
    - 독립적인 관계는 별개의 릴레이션으로 표현한다.

## 제 1정규화

- 테이블의 컬럼이 원자성을 갖도록 변경
    - 모든 도메인이 더 이상 분해될 수 없는 원자 값으로 구성하게 하는 것
    - 하나의 기본키에 대해 두 개 이상의 값을 가지는 반복 집합이 있어서는 안된다.

## 제 2정규화

- 테이블의 컬럼이 완전 종속을 만족하도록 변경
    - 부분 함수의 종속성 제거 ⇒ 기본키가 아닌 모든 속성이 기본키에 완전 함수종속적인 것
    - 기본키의 부분 집합(종속적)으로 결정되는 컬럼이 없어야 한다
- 동등한 릴레이션으로 분해해야 하며, 정보 손실이 발생하지 않는 무손실 분해가 이뤄져야 한다.

## 제 3정규화

- 이행적 함수 종속을 만족하지 않도록 변경
    - 이행적 함수 종속
        - X → Y, Y → Z일 때, X → Z가 성립하면서 C가 A에 대해 이행적으로 함수 종속이 되었다고 한다.
- 제 2정규화와 차이점으로 키에 대한 종속성이 아닌 컬럼 간의 종속을 해결한다

## BCNF(보이스/코드 정규형)

- 결정자가 후보키가 아닌 함수 종속 관계 제거 ⇒ 릴레이션의 모든 결정자는 후보키인 상태
    - 기본키가 아닌 컬럼으로 기본키를 식별할 수 있는 종속 제거

# 비정규화

- 정규화 되어 있는 테이블을 다시 합치는 방법
    - 무결성을 떨어뜨리고, 구조 설계를 무너뜨린다
- 읽기 성능 향상을 위한 설계 방법
    - 조회 속도는 빨라지지만 쓰기(삽입, 수정, 삭제)는 느려진다
